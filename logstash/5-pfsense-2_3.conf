#PFsense 2.3

filter {
  if "PFSense" in [tags] {

    grok {
     #Patterns forked from https://gist.github.com/elijahpaul
      patterns_dir => "/etc/logstash/conf.d/patterns"
      match => ["message","%{TIMESTAMP_ISO8601:timestamp8601} (%{IP}) (%{PROG:program}:) %{PFSENSE_LOG_DATA}%{PFSENSE_IP_SPECIFIC_DATA}%{PFSENSE_IP_DATA}%{PFSENSE_PROTOCOL_DATA}"]
    }
       geoip {
      add_tag => [ "GeoIP" ]
      source => "src_ip"
      # Optional GeoIP database
      database => "/etc/logstash/GeoLiteCity.dat"
    }
  }
}
